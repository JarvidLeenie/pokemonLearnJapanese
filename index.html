<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Pokémon Japanese Flashcards – All Generations</title>
<style>
@page { size: Letter landscape; margin: 0; }
body{margin:0;padding:0.25in;box-sizing:border-box;font-family:"Helvetica Neue",Arial,sans-serif;display:flex;flex-direction:column;align-items:center;gap:0.4in;}
.sheet{display:grid;grid-template-columns:2.5in 2.5in 0.5in 2.5in 2.5in;grid-auto-rows:3.5in;column-gap:0;row-gap:0.5in;width:calc(10in + 0.5in);height:7in;justify-content:center;align-content:center;}
.hidden{display:none}
.card{width:100%;height:100%;border:1px solid #000;border-radius:10px;padding:0.15in;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;}
.spacer{width:100%;height:100%}
.title{font-weight:700;font-size:1.05em;text-align:center;}
.subtitle{font-size:0.85em;color:#555;text-align:center;margin-top:-0.35em;}
.line{width:100%;border-top:1px solid #000;margin:0.15em 0;}
.section{font-weight:700;font-size:0.85em;text-align:center;width:100%;border-top:1px solid #888;border-bottom:1px solid #888;padding:0.15em 0;margin:0.25em 0 0.15em;}
.content{font-size:0.75em;line-height:1.3;width:100%;}
.content p{margin:0.15em 0;}
.image-box{height:1.5in;width:100%;display:flex;justify-content:center;align-items:center;}
.frame{border:1px solid #ccc;border-radius:8px;background:#fff;box-shadow:2px 2px 5px rgba(0,0,0,0.25);padding:6px;}
.frame img{max-width:70px;height:auto;display:block;}
#pager{display:flex;gap:0.2in;align-items:center;justify-content:center;flex-wrap:wrap;max-width:100%;}
#pager button{background:#eee;border:1px solid #888;border-radius:4px;padding:4px 10px;min-width:36px;font-size:0.9em;cursor:pointer;}
#pager button.active{background:#444;color:#fff;border-color:#444;}
#pager button:disabled{opacity:0.4;cursor:default;}
@media print{
  #pager{display:none}
  body{gap:0}
  .sheet{display:none !important;}
  .sheet:not(.hidden){display:flex !important;flex-wrap:wrap !important;justify-content:space-between !important;align-content:space-between !important;height:7in !important;width:10.5in !important;page-break-inside:avoid;}
  .card{width:2.5in !important;height:3.5in !important;page-break-inside:avoid;margin:0 !important;}
  .spacer{width:0.5in !important;height:3.5in !important;page-break-inside:avoid;}
}
</style>
</head>
<body>
<nav id="pager"></nav>
<div id="sheets"></div>
<script>
// Load the JSON data
let pokemonData = [];
let originsData = {};

// Function to load JSON files
async function loadData() {
    try {
        const [pokemonResponse, originsResponse] = await Promise.all([
            fetch('pokemon_base_0001_1025_with_local_images.json'),
            fetch('name_origins_0001_1025.json')
        ]);
        
        pokemonData = await pokemonResponse.json();
        originsData = await originsResponse.json();
        
        // Transform data to match the expected format
        const cards = pokemonData.map(pokemon => {
            const origin = originsData[pokemon.ndex] || {};
            const elements = origin.nameOriginElements || [];
            
            return {
                id: pokemon.ndex,
                kana: pokemon.kanaName,
                hira: pokemon.kanaName, // We'll use kana for hiragana display
                pub: pokemon.publishedName,
                hep: pokemon.hepburnName,
                img: pokemon.imageUrl,
                jp: elements.slice(1), // Skip the first element (Japanese name)
                en: [], // We'll leave this empty for now
                desc: origin.nameOriginDescription || ""
            };
        });
        
        // Build the flashcards
        buildSheets(cards);
        buildPager();
    } catch (error) {
        console.error('Error loading data:', error);
        document.body.innerHTML = '<h1>Error loading data</h1><p>Please make sure the JSON files are available.</p>';
    }
}

const jpFace=c=>`<div class='card'><div class='title'>${c.kana}</div><div class='subtitle'>(${c.hira})</div><div class='line'></div><div class='image-box'><div class='frame'><img src='${c.img}' alt='${c.kana}'/></div></div><div class='section'>日本語で名前の意味</div><div class='content'>${c.jp.map(t=>`<p>・${t}</p>`).join('')}</div></div>`;
const enFace=c=>`<div class='card'><div class='title'>${c.pub}</div>${c.hep!==c.pub?`<div class='subtitle'>(${c.hep})</div>`:''}<div class='line'></div><div class='image-box'><div class='frame'><img src='${c.img}' alt='${c.pub}'/></div></div><div class='section'>Name Origin</div><div class='content'>${c.en.map(t=>`<p>・${t}</p>`).join('')}<p style='margin-top:6px'>${c.desc}</p></div></div>`;

function buildSheets(cards){
  const container=document.getElementById('sheets');
  let html='';
  for(let i=0;i<cards.length;i+=4){
    const group=cards.slice(i,i+4);
    html+="<section class='sheet'>";
    group.forEach((c,idx)=>{
      html+=jpFace(c)+enFace(c);
      if(idx%2===0 && idx+1<group.length) html+="<div class='spacer'></div>";
    });
    html+="</section>";
  }
  container.innerHTML=html;
}

function buildPager(){
  const pager=document.getElementById('pager');
  const sheets=[...document.querySelectorAll('.sheet')];
  const totalPages = sheets.length;
  let current = 0;
  
  function generatePaginationHTML(currentPage, totalPages) {
    const delta = 2; // Number of pages to show before and after current
    const range = [];
    const rangeWithDots = [];
    
    for (let i = Math.max(2, currentPage - delta); i <= Math.min(totalPages - 1, currentPage + delta); i++) {
      range.push(i);
    }
    
    if (currentPage - delta > 2) {
      rangeWithDots.push(1, '...');
    } else {
      rangeWithDots.push(1);
    }
    
    rangeWithDots.push(...range);
    
    if (currentPage + delta < totalPages - 1) {
      rangeWithDots.push('...', totalPages);
    } else {
      rangeWithDots.push(totalPages);
    }
    
    let html = `<button id='first'>&laquo;</button><button id='prev'>&lsaquo;</button>`;
    
    rangeWithDots.forEach(item => {
      if (item === '...') {
        html += `<span style="padding: 4px 8px;">...</span>`;
      } else {
        const isActive = item === currentPage + 1;
        html += `<button class='page' data-page='${item-1}'${isActive ? ' class="page active"' : ''}>${item}</button>`;
      }
    });
    
    html += `<button id='next'>&rsaquo;</button><button id='last'>&raquo;</button>`;
    return html;
  }
  
  const render = () => {
    sheets.forEach((s, i) => s.classList.toggle('hidden', i !== current));
    pager.innerHTML = generatePaginationHTML(current, totalPages);
    
    // Re-attach event listeners
    pager.querySelector('#first').disabled = current === 0;
    pager.querySelector('#prev').disabled = current === 0;
    pager.querySelector('#next').disabled = current === totalPages - 1;
    pager.querySelector('#last').disabled = current === totalPages - 1;
    
    // Add click handlers
    pager.addEventListener('click', handlePagerClick);
  };
  
  function handlePagerClick(e) {
    if (e.target.tagName !== 'BUTTON') return;
    
    if (e.target.classList.contains('page')) {
      current = parseInt(e.target.dataset.page);
    } else {
      if (e.target.id === 'first') current = 0;
      else if (e.target.id === 'prev') current = Math.max(0, current - 1);
      else if (e.target.id === 'next') current = Math.min(totalPages - 1, current + 1);
      else if (e.target.id === 'last') current = totalPages - 1;
    }
    
    render();
  };
  
  render();
}

document.addEventListener('DOMContentLoaded', loadData);
</script>
</body>
</html>
